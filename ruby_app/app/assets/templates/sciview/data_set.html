<section class="discussion">
  <section class="discussion__closed" ng-if="$state.current.name !== 'data-sets.single.discuss'">
    <i class="discussion__cta-open" ui-sref="data-sets.single.discuss"></i>
    <i class="discussion__tab--notification"></i>
  </section>
  <section class="discussion__open" ng-if="$state.current.name === 'data-sets.single.discuss'">
    <i class="discussion__cta-close" ui-sref="data-sets.single"></i>
  </section>
</section>

<section class="data-set__current">
  <ul class="batches">
    <li class="batch" ng-repeat="chart in current_data_set.charts" ng-controller="UIChartController">
      <!-- Sidebar / Data representation for gjkkraph -->
      <section class="batch__sidebar">
        <section class="batch__header">
          <i class="batch__title-icon"></i>
          <h4 class="batch__title" ng-click="chart.refresh()" ng-bind="chart.title"></h4>
          <i class="batch__add-channel-action"></i>
        </section>
        <ul class="batch__data">

          <!-- Each data item -->
          <li class="batch__data-item">
            <input type="text"
                   ng-model="new_series_title"
                   typeahead="series as series.key for series in querySeriesList($viewValue) | limitTo:8"
                   typeahead-loading="filtering"
                   typeahead-template-url="/assets/sciview/autocomplete.html"
                   placeholder="Search key, tag or attribute:value">
            <a ng-click="addSeries(chart, new_series_title.key)">Add Series</a>
          </li>
          <li class="batch__data-item" ng-repeat="channel in chart.channels" >

            <!-- If the data item is a group -->
            <section class="channel__group" ng-class="channel.state">
              <!-- Retract group icon -->
              <i class="batch__data-group-expand" ng-click="toggleGroup(channel)"></i>
              <!-- Group Title -->
              <h5 class="batch__data-group-title" ng-bind="channel.title"></h5>
              <!-- Group data list -->
              <ul class="batch__data-group">
                <!-- Channel item -->
                <li class="channel is-group" ng-repeat="series in channel.series"
                ng-class="series.state">
                <!-- series dropdown -->
                <i class="channel__dropdown" ng-click="toggleGroup(series)"></i>
                <!-- series title -->
                <span class="channel__title" style="color: {{series.key.color}}"
                ng-bind="series.title"> </span>
                <span class="channel__key"
                style="border-color: {{series.key.color}}; border-bottom-style: {{series.key.style}}"> </span>
                <!-- series Category -->
                <span class="channel__category" ng-bind="series.category"> </span>
                <!-- series Metadata  -->
                <ul class="channel__meta"
                ng-include="'assets/sciview/metadata.html'"
                ng-controller="MetadataController"></ul>
              </li>
            </ul>
          </section>
        </li>

      </ul>
    </section>

    <!-- Visual chart representation for graph -->
    <section class="batch__chart">
      <div class="batch__chart-units-1">
      </div>
      <!-- Dummy Graph -->
    </section>
  </li>

  <li>
    <section class="batch__header">
      <a class="batch__title" ng-click="addChart()">+ Add New Graph</a>
    </section>
  </li>
  <li>
    <section class="batch__header">
      <a class="batch__title" ng-click="saveDataset()">+ Save DataSet</a>
    </section>
  </li>
  <li>
    <section class="batch__header">
      <a class="batch__title" ng-click="deleteDataset()">x Delete DataSet</a>
    </section>
  </li>
  <li>
      <section class="batch__header" ng-show="!states.is_renaming">
          <a class="batch__title" ng-click="states.is_renaming = true">| Rename DataSet</a>
      </section>
      <section class="batch__header" ng-if="states.is_renaming">
          <input type="text"
                 ng-model="temporary_data_set.title"
                 placeholder="Dataset name">

          <button ng-click="cancelRenaming()">Cancel
          </button>
          <button ng-click="saveRenaming()">Save
          </button>
      </section>
  </li>
</ul>
</section>

<section class="discuss" ui-view ng-class="{ 'is-discussing': $state.current.name === 'data-sets.single.discuss'}">
</section>

<section class="tools" ng-controller="ToolController" ng-include="'assets/sciview/partials/tool.html'">
</section>
